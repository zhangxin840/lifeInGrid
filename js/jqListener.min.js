(function(n){"use strict";var i="jqListener";var t=i,r=function(i,r){var u=n(i),h={keyword:"apple",language:"en",maxNum:6,firstNum:3,animation:!0,animationSpeed:2e3,fetchInterval:2e3},v=3e3,y=u.data(t+"-options"),r=n.extend(h,y,r),f={rrp:r.firstNum,isFirstFetch:!0,lastId:0},c=function(n){var r=n.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/g,function(n){return n.link(n)}),i=r.replace(/[#]+[A-Za-z0-9-_]+/g,function(n){var t=n.replace("#","%23");return n.link("http://search.twitter.com/search?q="+t)});return i.replace(/[@]+[A-Za-z0-9-_]+/g,function(n){var t=n.replace("@","");return n.link("http://twitter.com/"+t)})},o=function(){var t=u,s=r.keyword.replace("#","%23"),h=r.language,i;f.isFirstFetch&&(f.isFirstFetch=!1,f.lastId=0),i="http://search.twitter.com/search.json?q="+s+"&lang="+h+"&rpp="+f.rrp+"&since_id="+f.lastId,n.ajax({url:i,dataType:"jsonp",timeout:v,success:function(i){n(i.results).reverse().each(function(){var u="#tw",i=this,o;if(n(u+i.id,t).length===0){var s=new Date(Date.parse(i.created_at)),l=s.getHours()+":"+s.getMinutes(),h='<div id="tw'+i.id+'" class="tweet"><img width="48" height="48" src="'+i.profile_image_url+'" ><p class="text">'+c(i.text)+'<br />&nbsp;<b><a href="http://twitter.com/'+i.from_user+'" target="_blank">'+i.from_user+"</a></b> &nbsp;-&nbsp;<b>"+l+"</b></p></div>";f.lastId=i.id,o=t.find("div").length,o===e.options.maxNum&&t.find("div:last").remove(),t.prepend(h),r.animation===!0&&(n(u+i.id,t).hide(),n(u+i.id+" img",t).hide(),n(u+i.id+" img",t).fadeIn(r.animationSpeed),n(u+i.id,t).fadeIn(r.animationSpeed))}}),f.rrp=1,setTimeout(function(){o()},r.fetchInterval)},error:function(n,t){console.log("jqLietener: "+t),setTimeout(function(){o()},r.fetchInterval)}})},w=function(){s();u.on("click."+t,"h1",function(n){n.preventDefault(),p()})},p=function(){},s=function(){o()},l=function(n){u.children().remove(),r.keyword=n,f.rrp=h.firstNum},a=function(){u.off("."+t),u.find("*").off("."+t),u.removeData(t),u=null},e={};e.options=r,e.destroy=a,e.startListening=s,e.changeListening=l,w(),u.data(t,e)};n.fn.reverse=Array.prototype.reverse,n.fn.jqListener=function(n){return this.each(function(){r(this,n)}),this},n.fn.changeListening=function(t){return this.each(function(){var r=n(this).data(i);if(r)r.changeListening(t);else throw"Element not a valid container";}),this}})(jQuery);